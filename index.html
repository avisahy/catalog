<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Catalog PWA</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#121212" />
  <link rel="icon" href="icons/icon-192.png" type="image/png" />
  <link rel="stylesheet" href="style.css" />
  <script>
    // Minimal inline check to add dark or light before CSS to reduce FOUC
    (function () {
      const theme = localStorage.getItem('catalog-theme') || 'dark';
      document.documentElement.setAttribute('data-theme', theme);
      const fontSize = localStorage.getItem('catalog-font-size') || 'medium';
      document.documentElement.setAttribute('data-font-size', fontSize);
      const cols = localStorage.getItem('catalog-columns') || '3';
      document.documentElement.setAttribute('data-columns', cols);
    })();
  </script>
</head>
<body>
  <header class="app-header">
    <div class="logo-wrapper" id="home-logo">
      <div class="logo-3d">
        <span class="logo-front">C</span>
        <span class="logo-back">C</span>
      </div>
      <span class="logo-text">Catalog</span>
    </div>

    <div class="header-right">
      <button id="btn-voice-search" class="icon-button" title="Voice search">
        üéô
      </button>
      <button id="btn-theme-toggle" class="icon-button" title="Toggle theme">
        üåì
      </button>
      <div class="offline-indicator" id="offline-indicator" title="Offline">
        ‚ö† Offline
      </div>
    </div>
  </header>

  <nav class="app-nav">
    <button class="nav-button active" data-page="home">Home</button>
    <button class="nav-button" data-page="stats">Stats</button>
    <button class="nav-button" data-page="settings">Settings</button>
  </nav>

  <main id="page-container">
    <!-- HOME PAGE -->
    <section id="page-home" class="page active">
      <div class="toolbar">
        <input
          id="search-input"
          class="search-input"
          type="search"
          placeholder="Search by name or location"
        />
        <button id="btn-clear-search" class="icon-button" title="Clear search">‚úñ</button>

        <button id="btn-filter-favorites" class="toggle-button" title="Filter favorites">
          ‚òÖ
        </button>
      </div>

      <div class="batch-toolbar" id="batch-toolbar">
        <span id="batch-count">0 selected</span>
        <div class="batch-actions">
          <button id="batch-favorite" class="ghost-button">Favorite</button>
          <button id="batch-delete" class="ghost-button">Delete</button>
          <button id="batch-export" class="ghost-button">Export</button>
          <button id="batch-share" class="ghost-button">Share QR</button>
          <button id="batch-cancel" class="ghost-button">Cancel</button>
        </div>
      </div>

      <div id="skeleton-container" class="card-grid skeleton-grid">
        <!-- Skeleton cards (shown while loading) -->
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
      </div>

      <div id="card-grid" class="card-grid hidden">
        <!-- Cards dynamically inserted here -->
      </div>
    </section>

    <!-- STATS PAGE -->
    <section id="page-stats" class="page">
      <h2>Statistics</h2>
      <div class="stats-container">
        <div class="stat-card">
          <span class="stat-label">Total items</span>
          <span id="stat-total-items" class="stat-value">0</span>
        </div>
        <div class="stat-card">
          <span class="stat-label">Favorites</span>
          <span id="stat-total-favorites" class="stat-value">0</span>
        </div>
      </div>

      <h3>Recently added</h3>
      <ul id="recent-items-list" class="timeline"></ul>
    </section>

    <!-- SETTINGS PAGE -->
    <section id="page-settings" class="page">
      <h2>Settings</h2>

      <div class="setting-group">
        <h3>Theme</h3>
        <div class="segmented-control">
          <button data-theme="light" class="segmented-option">Light</button>
          <button data-theme="dark" class="segmented-option">Dark</button>
        </div>
      </div>

      <div class="setting-group">
        <h3>Text size</h3>
        <div class="segmented-control">
          <button data-font="small" class="segmented-option">Small</button>
          <button data-font="medium" class="segmented-option">Medium</button>
          <button data-font="large" class="segmented-option">Large</button>
        </div>
      </div>

      <div class="setting-group">
        <h3>Grid columns</h3>
        <div class="segmented-control">
          <button data-columns="2" class="segmented-option">2</button>
          <button data-columns="3" class="segmented-option">3</button>
          <button data-columns="4" class="segmented-option">4</button>
        </div>
      </div>

      <div class="setting-group">
        <h3>Data & backup</h3>
        <div class="setting-actions">
          <button id="btn-export-db" class="primary-button">Export all</button>
          <button id="btn-import-db" class="secondary-button">Import</button>
          <button id="btn-delete-all" class="danger-button">Delete all</button>
        </div>
        <input id="file-input-import" type="file" accept="application/json" hidden />
      </div>

      <div class="setting-group">
        <h3>Backup & reminders</h3>
        <p class="setting-note">
          Backups are automatically exported every day (local download) and you‚Äôll get reminders if you haven‚Äôt
          backed up in a while.
        </p>
        <div class="backup-info">
          <span>Last backup: <span id="last-backup-label">Never</span></span>
          <button id="btn-backup-now" class="secondary-button">Backup now</button>
        </div>
      </div>
    </section>
  </main>

  <!-- FLOATING ACTION BUTTON -->
  <button id="fab-add-item" class="fab" title="Add item">Ôºã</button>

  <!-- ADD / EDIT ITEM MODAL -->
  <div id="modal-add-edit" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content card-3d">
      <header class="modal-header">
        <h2 id="modal-add-edit-title">Add item</h2>
        <button class="icon-button" id="modal-add-edit-close">‚úñ</button>
      </header>

      <div class="modal-body">
        <label class="field">
          <span>Name</span>
          <input type="text" id="item-name-input" />
        </label>
        <label class="field">
          <span>Location</span>
          <input type="text" id="item-location-input" />
        </label>
        <label class="field">
          <span>Image</span>
          <input type="file" id="item-image-input" accept="image/*" />
        </label>
      </div>

      <footer class="modal-footer">
        <button id="btn-save-item" class="primary-button">Save</button>
      </footer>
    </div>
  </div>

  <!-- ITEM PREVIEW MODAL -->
  <div id="modal-preview" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content modal-preview card-3d">
      <header class="modal-header">
        <button id="preview-back" class="icon-button">‚Üê</button>
        <h2 id="preview-title">Item</h2>
        <button id="preview-favorite" class="icon-button" title="Favorite">‚òÜ</button>
      </header>

      <div class="modal-body preview-body" id="preview-body">
        <div class="preview-image-wrapper">
          <img id="preview-image" alt="" />
        </div>
        <div class="preview-info">
          <div class="preview-row">
            <span class="preview-label">Name</span>
            <span id="preview-name" class="preview-value"></span>
          </div>
          <div class="preview-row">
            <span class="preview-label">Location</span>
            <span id="preview-location" class="preview-value"></span>
          </div>
        </div>
      </div>

      <footer class="modal-footer preview-footer">
        <div class="preview-actions">
          <button id="preview-prev" class="icon-button" title="Previous item">‚ü®</button>
          <button id="preview-next" class="icon-button" title="Next item">‚ü©</button>

          <button id="preview-share-whatsapp" class="secondary-button">WhatsApp</button>
          <button id="preview-share-link" class="secondary-button">Share link</button>
          <button id="preview-share-qr" class="secondary-button">QR</button>
          <button id="preview-export" class="secondary-button">Export</button>
          <button id="preview-delete" class="danger-button">Delete</button>
        </div>
      </footer>
    </div>
  </div>

  <!-- QR MODAL -->
  <div id="modal-qr" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content card-3d">
      <header class="modal-header">
        <h2>Share QR</h2>
        <button class="icon-button" id="modal-qr-close">‚úñ</button>
      </header>
      <div class="modal-body qr-body">
        <canvas id="qr-canvas" width="256" height="256"></canvas>
        <p class="qr-note">Scan this QR code to view these items.</p>
      </div>
    </div>
  </div>

  <!-- IMPORT CONFLICT MODAL -->
  <div id="modal-import-conflicts" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content card-3d">
      <header class="modal-header">
        <h2>Import conflicts</h2>
        <button class="icon-button" id="modal-import-conflicts-close">‚úñ</button>
      </header>
      <div class="modal-body conflicts-body">
        <p>Duplicates were found. Choose what to do for each.</p>
        <div id="conflict-list"></div>
      </div>
      <footer class="modal-footer">
        <button id="conflicts-apply" class="primary-button">Apply</button>
      </footer>
    </div>
  </div>

  <!-- IMPORT SUMMARY MODAL -->
  <div id="modal-import-summary" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content card-3d">
      <header class="modal-header">
        <h2>Import summary</h2>
        <button class="icon-button" id="modal-import-summary-close">‚úñ</button>
      </header>
      <div class="modal-body">
        <p id="import-summary-text"></p>
        <ul id="import-errors"></ul>
      </div>
    </div>
  </div>

  <!-- SNACKBAR -->
  <div id="snackbar" class="snackbar">
    <span id="snackbar-message"></span>
    <button id="snackbar-action"></button>
  </div>

  <script src="db.js"></script>
  <script src="script.js"></script>
</body>
</html>

