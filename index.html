<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Catalog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/png" href="icons/icon-192.png" />

  <meta name="theme-color" content="#111111" />

  <link rel="stylesheet" href="style.css" />

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
  </script>
</head>
<body class="theme-dark text-size-medium layout-3cols">
  <!-- Top bar -->
  <header class="top-bar">
    <a href="/" class="logo-link" id="homeLogo">
      <div class="logo-3d">C</div>
      <span class="logo-text">Catalog</span>
    </a>

    <div class="top-bar-right">
      <button id="offlineIndicator" class="offline-indicator" title="Offline status"></button>

      <button id="voiceSearchBtn" class="icon-button" title="Voice search">
        ðŸŽ¤
      </button>

      <label class="toggle-wrapper" title="Dark / Light mode">
        <input type="checkbox" id="themeToggle" checked />
        <span class="toggle"></span>
      </label>
    </div>
  </header>

  <!-- Main container with animated page transitions -->
  <main id="mainContainer" class="page-container">
    <!-- Home / Catalog page -->
    <section id="pageHome" class="page active">
      <div class="toolbar">
        <input
          type="search"
          id="searchInput"
          placeholder="Search by name or location"
        />

        <select id="favoriteFilter">
          <option value="all">All</option>
          <option value="favorites">Favorites</option>
        </select>

        <select id="layoutSelect">
          <option value="2">2 cols</option>
          <option value="3" selected>3 cols</option>
          <option value="4">4 cols</option>
        </select>

        <select id="textSizeSelect">
          <option value="small">A-</option>
          <option value="medium" selected>A</option>
          <option value="large">A+</option>
        </select>
      </div>

      <!-- Batch actions toolbar -->
      <div id="batchToolbar" class="batch-toolbar hidden">
        <span id="batchCount">0 selected</span>
        <button data-batch-action="favorite">Favorite</button>
        <button data-batch-action="share">Share</button>
        <button data-batch-action="export">Export</button>
        <button data-batch-action="delete" class="danger">Delete</button>
        <button id="batchClearBtn">Clear</button>
      </div>

      <!-- Skeleton loader -->
      <div id="skeletonContainer" class="card-grid skeleton-grid">
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
        <div class="card skeleton-card"></div>
      </div>

      <!-- Items grid -->
      <div id="itemsGrid" class="card-grid hidden"></div>
    </section>

    <!-- Preview page (overlay style) -->
    <section id="pagePreview" class="page">
      <div class="preview-overlay">
        <button id="previewCloseBtn" class="icon-button preview-close">âœ•</button>

        <div class="preview-card" id="previewCard">
          <div class="preview-image-wrapper">
            <img id="previewImage" src="" alt="" />
          </div>
          <div class="preview-details">
            <h2 id="previewName"></h2>
            <p id="previewLocation" class="muted"></p>

            <div class="preview-actions">
              <button id="previewFavoriteBtn">Favorite</button>
              <button id="previewExportBtn">Export</button>
              <button id="previewShareWhatsAppBtn">WhatsApp</button>
              <button id="previewShareQRBtn">QR</button>
              <button id="previewShareLinkBtn">Link</button>
              <button id="previewDeleteBtn" class="danger">Delete</button>
            </div>

            <div class="preview-swipe-hint">
              Swipe left/right to navigate
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Settings page -->
    <section id="pageSettings" class="page">
      <h1>Settings</h1>

      <section class="settings-section">
        <h2>Theme</h2>
        <p>Choose your color theme.</p>
        <div class="theme-choices">
          <button class="theme-choice" data-theme="dark">Dark</button>
          <button class="theme-choice" data-theme="light">Light</button>
          <button class="theme-choice" data-theme="custom">Custom</button>
        </div>
      </section>

      <section class="settings-section">
        <h2>Backups</h2>
        <p>Manage export, import, and backup reminders.</p>
        <div class="settings-buttons">
          <button id="exportAllBtn">Export all</button>
          <button id="importBtn">Import</button>
          <input type="file" id="importFileInput" accept="application/json" hidden />

          <button id="backupNowBtn">Backup now</button>
        </div>
        <label>
          Backup reminder every
          <input type="number" id="backupDaysInput" min="1" value="1" />
          days
        </label>
        <p id="lastBackupInfo" class="muted"></p>
      </section>
    </section>

    <!-- Stats page -->
    <section id="pageStats" class="page">
      <h1>Statistics</h1>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Total items</div>
          <div class="stat-value" id="statTotalItems">0</div>
        </div>
      </div>

      <h2>Recently added</h2>
      <ul id="recentTimeline" class="timeline"></ul>
    </section>
  </main>

  <!-- Bottom nav (for pages) -->
  <nav class="bottom-nav">
    <button data-nav="home" class="nav-btn active">Home</button>
    <button data-nav="settings" class="nav-btn">Settings</button>
    <button data-nav="stats" class="nav-btn">Stats</button>
  </nav>

  <!-- Floating action button (FAB) -->
  <div class="fab-container">
    <button id="fabMain" class="fab">ï¼‹</button>
    <div id="fabMenu" class="fab-menu">
      <button data-fab-action="add">Add item</button>
      <button data-fab-action="import">Import</button>
      <button data-fab-action="export">Export all</button>
      <button data-fab-action="deleteAll" class="danger">Delete all</button>
    </div>
  </div>

  <!-- Hidden canvas for QR and image hashing if needed -->
  <canvas id="hiddenCanvas" style="display:none;"></canvas>

  <!-- Snackbar for undo / messages -->
  <div id="snackbar" class="snackbar"></div>

  <!-- QR modal -->
  <div id="qrModal" class="modal hidden">
    <div class="modal-content">
      <button id="qrCloseBtn" class="icon-button modal-close">âœ•</button>
      <h2>Share via QR</h2>
      <div id="qrContainer"></div>
    </div>
  </div>

  <!-- Conflict dialog -->
  <div id="conflictModal" class="modal hidden">
    <div class="modal-content">
      <h2>Conflict detected</h2>
      <p id="conflictText"></p>
      <div class="modal-actions">
        <button id="conflictKeepExistingBtn">Keep existing</button>
        <button id="conflictKeepImportedBtn">Keep imported</button>
        <button id="conflictSkipBtn">Skip</button>
      </div>
    </div>
  </div>

  <!-- Import mode dialog -->
  <div id="importModeModal" class="modal hidden">
    <div class="modal-content">
      <h2>Import mode</h2>
      <p>Choose how to import items.</p>
      <div class="modal-actions">
        <button id="importMergeBtn">Merge all</button>
        <button id="importReplaceBtn" class="danger">Replace all</button>
        <button id="importSelectBtn">Select items</button>
      </div>
    </div>
  </div>

  <!-- Import selection dialog -->
  <div id="importSelectModal" class="modal hidden">
    <div class="modal-content import-select-content">
      <h2>Select items to import</h2>
      <div id="importSelectList" class="import-select-list"></div>
      <div class="modal-actions">
        <button id="importSelectConfirmBtn">Import selected</button>
        <button id="importSelectCancelBtn">Cancel</button>
      </div>
    </div>
  </div>

  <script src="db.js"></script>
  <script src="script.js"></script>
</body>
</html>
